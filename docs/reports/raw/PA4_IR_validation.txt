PA4 IR Validation
Generated on Wed Oct 29 01:08:26 CDT 2025

=======================================================================
FILE: test_F25_00.txt
=======================================================================

SOURCE CODE:
----------------------------------------
main

int x, y, z;

// cp cf dce
{
    x = 51;
    y = 2 * x + y;
    x = x + y * 2 + z;
    call printInt(y);
}.

BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{1: store 51 x_0 | 2: load t0 x_0 | 3: mul t1 2 t0 | 4: load t0 y_0 | 5: add t2 t1 t0 | 6: store t2 y_0 | 7: load t0 y_0 | 8: mul t1 t0 2 | 9: load t0 x_0 | 10: add t3 t0 t1 | 11: load t1 z_0 | 12: add t0 t3 t1 | 13: store t0 x_0 | 14: load t1 y_0 | 15: write t1 | 16: end}"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{17: mov x_1 51 | 3: mul t1 2 x_2 | 5: add t2 t1 y_1 | 18: mov y_1 t2 | 8: mul t1 y_1 2 | 10: add t3 x_2 t1 | 12: add t0 t3 z_0 | 19: mov x_2 t0 | 15: write y_1 | 16: end}"];
}



=======================================================================
FILE: test_F25_01.txt
=======================================================================

SOURCE CODE:
----------------------------------------
main
int a;

// Constant Folding and Constant Propagration
{
    a = ( ( ( 2 + 1 ) * 2 ) / 2 ) - 1;
    call printInt(a); // 2
    call println();
    a = 5*3+7;
    call printInt(a);  // 22
    call println();
}.

BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{1: add t0 2 1 | 2: mul t1 t0 2 | 3: div t0 t1 2 | 4: sub t1 t0 1 | 5: store t1 a_0 | 6: load t0 a_0 | 7: write t0 | 8: writeNL | 9: mul t2 5 3 | 10: add t3 t2 7 | 11: store t3 a_0 | 12: load t2 a_0 | 13: write t2 | 14: writeNL | 15: end}"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{1: add t0 2 1 | 2: mul t1 t0 2 | 3: div t0 t1 2 | 4: sub t1 t0 1 | 16: mov a_1 t1 | 7: write a_2 | 8: writeNL | 9: mul t2 5 3 | 10: add t3 t2 7 | 17: mov a_2 t3 | 13: write a_2 | 14: writeNL | 15: end}"];
}



=======================================================================
FILE: test_F25_02.txt
=======================================================================

SOURCE CODE:
----------------------------------------
main

//dce local, cf

function early_return () : int
{
    int c, d, unused;

    c = 1; // dce - overwritten
    c = 2;
    unused = c / d; // dce - unused
    return c * d;
};

function unreachableIf () : void
{
    int c, d;

    c = 1;
    d = 2;
    if (d == c) then
        d = c;
    fi;

    if (false) then
        call println();
    else
        call println();
    fi;

    if (true) then
        call println();
    else
        call println();
    fi;

    if (true) then
        call println();
    fi;

    if (false) then
        call println();
    fi;

};

{
    call unreachableIf();
    call printInt(call early_return());
}.

BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb2 [shape=record, label="<b>BB2|{1: store 1 c_0 | 2: store 2 c_0 | 3: load t0 d_0 | 4: load t1 c_0 | 5: div t2 t1 t0 | 6: store t2 unused_0 | 7: load t0 d_0 | 8: load t1 c_0 | 9: mul t3 t1 t0 | 10: return t3}"];
bb3 [shape=record, label="<b>BB3|{11: end}"];
}

digraph G {
bb4 [shape=record, label="<b>BB4|{12: store 1 c_0 | 13: store 2 d_0 | 14: load t0 c_0 | 15: load t1 d_0 | 16: cmpeq t4 t1 t0 | 17: beq t4 BB6}"];
bb5 [shape=record, label="<b>BB5|{18: load t0 c_0 | 19: store t0 d_0 | 20: bra BB6}"];
bb6 [shape=record, label="<b>BB6|{21: beq false BB9}"];
bb7 [shape=record, label="<b>BB7|{22: writeNL | 23: bra BB8}"];
bb8 [shape=record, label="<b>BB8|{26: beq true BB12}"];
bb9 [shape=record, label="<b>BB9|{24: writeNL | 25: bra BB8}"];
bb10 [shape=record, label="<b>BB10|{27: writeNL | 28: bra BB11}"];
bb11 [shape=record, label="<b>BB11|{31: beq true BB14}"];
bb12 [shape=record, label="<b>BB12|{29: writeNL | 30: bra BB11}"];
bb13 [shape=record, label="<b>BB13|{32: writeNL | 33: bra BB14}"];
bb14 [shape=record, label="<b>BB14|{34: beq false BB16}"];
bb15 [shape=record, label="<b>BB15|{35: writeNL | 36: bra BB16}"];
bb16 [shape=record, label="<b>BB16|{37: end}"];
bb4:s -> bb6:n [label="fall-through"];
bb4:s -> bb5:n [label="fall-through"];
bb5:s -> bb6:n [label="fall-through"];
bb6:s -> bb9:n [label="fall-through"];
bb6:s -> bb7:n [label="fall-through"];
bb7:s -> bb8:n [label="fall-through"];
bb8:s -> bb12:n [label="fall-through"];
bb8:s -> bb10:n [label="fall-through"];
bb9:s -> bb8:n [label="fall-through"];
bb10:s -> bb11:n [label="fall-through"];
bb11:s -> bb14:n [label="fall-through"];
bb11:s -> bb13:n [label="fall-through"];
bb12:s -> bb11:n [label="fall-through"];
bb13:s -> bb14:n [label="fall-through"];
bb14:s -> bb16:n [label="fall-through"];
bb14:s -> bb15:n [label="fall-through"];
bb15:s -> bb16:n [label="fall-through"];
}

digraph G {
bb1 [shape=record, label="<b>BB1|{38: t1 = call unreachableIf() | 39: t1 = call early_return() | 40: write t1 | 41: end}"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb2 [shape=record, label="<b>BB2|{12: mov c_1 1 | 13: mov c_2 2 | 5: div t2 c_2 d_0 | 14: mov unused_1 t2 | 9: mul t3 c_2 d_0 | 10: return t3}"];
bb3 [shape=record, label="<b>BB3|{11: end}"];
}

digraph G {
bb4 [shape=record, label="<b>BB4|{49: mov c_1 1 | 50: mov d_1 2 | 16: cmpeq t4 d_1 c_1 | 17: beq t4 BB6}"];
bb5 [shape=record, label="<b>BB5|{51: mov d_12 c_1 | 20: bra BB6}"];
bb6 [shape=record, label="<b>BB6|{38: d_8 = phi [BB4: d_1, BB5: d_12] | 21: beq false BB9}"];
bb7 [shape=record, label="<b>BB7|{40: d_6 = phi [BB6: d_8] | 22: writeNL | 23: bra BB8}"];
bb8 [shape=record, label="<b>BB8|{41: d_2 = phi [BB9: d_4, BB7: d_6] | 26: beq true BB12}"];
bb9 [shape=record, label="<b>BB9|{39: d_4 = phi [BB6: d_8] | 24: writeNL | 25: bra BB8}"];
bb10 [shape=record, label="<b>BB10|{42: d_3 = phi [BB8: d_2] | 27: writeNL | 28: bra BB11}"];
bb11 [shape=record, label="<b>BB11|{44: d_7 = phi [BB10: d_3, BB12: d_13] | 31: beq true BB14}"];
bb12 [shape=record, label="<b>BB12|{43: d_13 = phi [BB8: d_2] | 29: writeNL | 30: bra BB11}"];
bb13 [shape=record, label="<b>BB13|{45: d_5 = phi [BB11: d_7] | 32: writeNL | 33: bra BB14}"];
bb14 [shape=record, label="<b>BB14|{46: d_9 = phi [BB13: d_5, BB11: d_7] | 34: beq false BB16}"];
bb15 [shape=record, label="<b>BB15|{47: d_10 = phi [BB14: d_9] | 35: writeNL | 36: bra BB16}"];
bb16 [shape=record, label="<b>BB16|{48: d_11 = phi [BB14: d_9, BB15: d_10] | 37: end}"];
bb4:s -> bb6:n [label="fall-through"];
bb4:s -> bb5:n [label="fall-through"];
bb5:s -> bb6:n [label="fall-through"];
bb6:s -> bb9:n [label="fall-through"];
bb6:s -> bb7:n [label="fall-through"];
bb7:s -> bb8:n [label="fall-through"];
bb8:s -> bb12:n [label="fall-through"];
bb8:s -> bb10:n [label="fall-through"];
bb9:s -> bb8:n [label="fall-through"];
bb10:s -> bb11:n [label="fall-through"];
bb11:s -> bb14:n [label="fall-through"];
bb11:s -> bb13:n [label="fall-through"];
bb12:s -> bb11:n [label="fall-through"];
bb13:s -> bb14:n [label="fall-through"];
bb14:s -> bb16:n [label="fall-through"];
bb14:s -> bb15:n [label="fall-through"];
bb15:s -> bb16:n [label="fall-through"];
bb4:s -> bb8:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb10:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb9:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb13:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb7:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb11:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb6:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb14:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb15:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb16:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb5:n [style=dotted,color=blue,label="dom"];
bb4:s -> bb12:n [style=dotted,color=blue,label="dom"];
}

digraph G {
bb1 [shape=record, label="<b>BB1|{38: t1 = call unreachableIf() | 39: t1 = call early_return() | 40: write t1 | 41: end}"];
}



=======================================================================
FILE: test_F25_03.txt
=======================================================================

SOURCE CODE:
----------------------------------------
// cse ofe

main

int x;
int y;
int z;
int w;

function nevercalled () : void
{
    x = 1;
};

{	
    x = 1;
    y = x + 2; 
    z = x + 2;

    x = 2;
    w = x + 2; // should not be replaced
}.

BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb2 [shape=record, label="<b>BB2|{1: store 1 x_0 | 2: end}"];
}

digraph G {
bb1 [shape=record, label="<b>BB1|{3: store 1 x_0 | 4: load t0 x_0 | 5: add t1 t0 2 | 6: store t1 y_0 | 7: load t0 x_0 | 8: add t2 t0 2 | 9: store t2 z_0 | 10: store 2 x_0 | 11: load t0 x_0 | 12: add t3 t0 2 | 13: store t3 w_0 | 14: end}"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb2 [shape=record, label="<b>BB2|{3: mov x_1 1 | 2: end}"];
}

digraph G {
bb1 [shape=record, label="<b>BB1|{15: mov x_1 1 | 5: add t1 x_2 2 | 16: mov y_1 t1 | 8: add t2 x_2 2 | 17: mov z_1 t2 | 18: mov x_2 2 | 12: add t3 x_2 2 | 19: mov w_1 t3 | 14: end}"];
}



=======================================================================
FILE: test_F25_04.txt
=======================================================================

SOURCE CODE:
----------------------------------------
// cp

main

int x;

{

    x = 2;

    call printInt(x); // 2 
    while (x < 5) do // should not propagate x = 2 here 

        x++;
    od;
}.

BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{1: store 2 x_0 | 2: load t0 x_0 | 3: write t0 | 4: load t1 x_0 | 5: cmplt t2 t1 5 | 6: beq t2 BB3}"];
bb2 [shape=record, label="<b>BB2|{7: load t1 x_0 | 8: add t3 t1 #1 | 9: store t3 x_0 | 10: bra BB1}"];
bb3 [shape=record, label="<b>BB3|{11: end}"];
bb1:s -> bb3:n [label="fall-through"];
bb1:s -> bb2:n [label="fall-through"];
bb2:s -> bb1:n [label="fall-through"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------


=======================================================================
FILE: test_F25_05.txt
=======================================================================

SOURCE CODE:
----------------------------------------
// Test for max (cp, cpp, cse, cf)
main

int a, b, c, d, e, x, y, z;

// max 
{
    a = call readInt();
    b = call readInt();
    x = 1;
    y = a + b;
    z = y * y;
    c = x * y;
    e = a + b;
    d = e * e;
    e = x - 1;
    b = e + 4;
    x = a + b;
    y = y * x;
    
    call printInt(x);
    call printInt(y);

}.
BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{1: read t0 | 2: store t0 a_0 | 3: read t1 | 4: store t1 b_0 | 5: store 1 x_0 | 6: load t2 b_0 | 7: load t3 a_0 | 8: add t4 t3 t2 | 9: store t4 y_0 | 10: load t2 y_0 | 11: load t3 y_0 | 12: mul t5 t3 t2 | 13: store t5 z_0 | 14: load t2 y_0 | 15: load t3 x_0 | 16: mul t6 t3 t2 | 17: store t6 c_0 | 18: load t2 b_0 | 19: load t3 a_0 | 20: add t7 t3 t2 | 21: store t7 e_0 | 22: load t2 e_0 | 23: load t3 e_0 | 24: mul t8 t3 t2 | 25: store t8 d_0 | 26: load t2 x_0 | 27: sub t3 t2 1 | 28: store t3 e_0 | 29: load t2 e_0 | 30: add t9 t2 4 | 31: store t9 b_0 | 32: load t2 b_0 | 33: load t10 a_0 | 34: add t11 t10 t2 | 35: store t11 x_0 | 36: load t2 x_0 | 37: load t10 y_0 | 38: mul t12 t10 t2 | 39: store t12 y_0 | 40: load t2 x_0 | 41: write t2 | 42: load t10 y_0 | 43: write t10 | 44: end}"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{1: read t0 | 45: mov a_1 t0 | 3: read t1 | 46: mov b_1 t1 | 47: mov x_1 1 | 8: add t4 a_1 b_2 | 48: mov y_1 t4 | 12: mul t5 y_2 y_2 | 49: mov z_1 t5 | 16: mul t6 x_2 y_2 | 50: mov c_1 t6 | 20: add t7 a_1 b_2 | 51: mov e_1 t7 | 24: mul t8 e_2 e_2 | 52: mov d_1 t8 | 27: sub t3 x_2 1 | 53: mov e_2 t3 | 30: add t9 e_2 4 | 54: mov b_2 t9 | 34: add t11 a_1 b_2 | 55: mov x_2 t11 | 38: mul t12 y_2 x_2 | 56: mov y_2 t12 | 41: write x_2 | 43: write y_2 | 44: end}"];
}



=======================================================================
FILE: test_F25_06.txt
=======================================================================

SOURCE CODE:
----------------------------------------
// cp cf

main

int a;
int b;
int c;
int d;
bool e;
bool f;
float g;
float h;

{	
    a = 5;
    // Are these operations handled?
    b = a % a;
    b = a / a;
    b = a - a;
    b = a / 1;
    b = a + 0;
    b = 0 + a;
    b = a - 0;
    // Is this handled for floats?
    g = 5.0;
    h = g + 0.0;
    h = g - 0.0;
    h = g * 1.0;
    h = g / 1.0;
    h = g * 0.0;
    h = 0.0 / g;
    // Are same relations considered?
    if (a < a) then
        c = 5
	  fi;
    if (a > a) then
        c = 6
	  fi;
    if (a >= a) then
        c = 7
	  fi;
    if (a <= a) then
        c = 8
	  fi;
    if (a == a) then
        c = 9
	  fi;
    if (a != a) then
        c = 10
	  fi;
    // How about boolean logic?
    e = true;
    f = e AND false;
    e = false;
    f = e OR true;
}.

BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Error parsing file.
SyntaxError(35,4)[Expected SEMICOLON but got FI.]


AFTER OPTIMIZATION (SSA IR):
----------------------------------------
Error parsing file.
SyntaxError(35,4)[Expected SEMICOLON but got FI.]



=======================================================================
FILE: test_F25_07.txt
=======================================================================

SOURCE CODE:
----------------------------------------
// cp cf 
// be careful with global vars, I'm not expecting you to handle global vars as constant
// but you can

main 

int x, y, z;

function foo(int y) : bool {
	int z;
	z = 5;
	if (x < z + y) then
		return true;
	else 
		return false;
	fi;
};

{
	x = 14;
	y = 5;
	z = 10;
	call printBool(call foo(y));
	x = 9;
	call printBool(call foo(y));
}.
BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb2 [shape=record, label="<b>BB2|{1: store 5 z_0 | 2: load t0 y_0 | 3: load t1 z_0 | 4: add t2 t1 t0 | 5: load t0 x_0 | 6: cmplt t1 t0 t2 | 7: beq t1 BB5}"];
bb3 [shape=record, label="<b>BB3|{8: return true}"];
bb4 [shape=record, label="<b>BB4|{12: end}"];
bb5 [shape=record, label="<b>BB5|{10: return false}"];
bb6 [shape=record, label="<b>BB6|{9: bra BB4}"];
bb7 [shape=record, label="<b>BB7|{11: bra BB4}"];
bb2:s -> bb5:n [label="fall-through"];
bb2:s -> bb3:n [label="fall-through"];
bb6:s -> bb4:n [label="fall-through"];
bb7:s -> bb4:n [label="fall-through"];
}

digraph G {
bb1 [shape=record, label="<b>BB1|{13: store 14 x_0 | 14: store 5 y_0 | 15: store 10 z_0 | 16: load t2 y_0 | 17: t0 = call foo(t2) | 18: writeB t0 | 19: store 9 x_0 | 20: load t3 y_0 | 21: t4 = call foo(t3) | 22: writeB t4 | 23: end}"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------


=======================================================================
FILE: test_F25_08.txt
=======================================================================

SOURCE CODE:
----------------------------------------
// copy propagation transitive test

main

int a, b, c, d;

{
    b = a;
    c = b;
    d = c;
    d = d + 1;

    call printInt(a); // 0
    call printInt(b); // 0
    call printInt(c); // 0
    call printInt(d); // 1
}.
BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{1: load t0 a_0 | 2: store t0 b_0 | 3: load t1 b_0 | 4: store t1 c_0 | 5: load t2 c_0 | 6: store t2 d_0 | 7: load t3 d_0 | 8: add t4 t3 1 | 9: store t4 d_0 | 10: load t3 a_0 | 11: write t3 | 12: load t5 b_0 | 13: write t5 | 14: load t6 c_0 | 15: write t6 | 16: load t7 d_0 | 17: write t7 | 18: end}"];
}


AFTER OPTIMIZATION (SSA IR):
----------------------------------------
Before optimization
----------------------------------------------------------------------------------------------------
digraph G {
bb1 [shape=record, label="<b>BB1|{19: mov b_1 a_0 | 20: mov c_1 b_1 | 21: mov d_1 c_1 | 8: add t4 d_2 1 | 22: mov d_2 t4 | 11: write a_0 | 13: write b_1 | 15: write c_1 | 17: write d_2 | 18: end}"];
}



=======================================================================
FILE: test_F25_09.txt
=======================================================================

SOURCE CODE:
----------------------------------------
// Constant folding with identity properties
// and constant propagation

main
int a,b,c,d,e;
{
    a = 5;
    b = a * 1; // b = 5
    c = a * 0; // c = 0
    d = a + 0; // d = 5
    e = a ^ 1; // e = 5
    call printInt(a);
    call printInt(b);
    call printInt(c);
    call printInt(d);
    call printInt(e);
}.
BEFORE OPTIMIZATION (Non-SSA IR):
----------------------------------------
